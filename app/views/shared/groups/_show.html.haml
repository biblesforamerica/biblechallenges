
.row
  .col-sm-12
    %h3= group.name

    = group.members.count
    = "member".pluralize(group.members.count)

    %br
    = instant_hangout


%table.table.table-striped.table-bordered.table-hover
  %thead
    %tr
      %th Members
      %th Stats
      %th Last Read
  %tbody
  - group.members.each do |m|
    %tr
      %td
        = render 'shared/avatar', user: m
        %span
          = m.decorate.name
      %td= m.membership_readings.size
      - if m.has_logged_a_reading?(m, group)
        %td= m.decorate.show_last_recorded_reading(m, group)
      - else
        %td
          No readings yet

.row
  .col-sm-12
    .pull-right
      - if current_user
        - if current_user.groups.include?(group)
          = link_to "Leave Group", leave_member_group_path(id: group.id), :class=>"btn btn-info", method: :post, data: {confirm: "Are you sure you want to leave this group?"}
        -else
          = link_to "Join Group", join_member_group_path(id: group.id), :class=> "btn btn-primary", method: :post
      - else
        = link_to "Sign me up", new_user_registration_path, :class=> "btn btn-primary"
      %span
      - if current_user && group.user_id == current_user.id
        = link_to "Delete Group", member_group_path(id: group.id), :class=>"btn btn-danger", method: :delete, data: {confirm: "Are you sure you want to delete this group?"}

%br


.row
  .col-sm-12
    %h4 Group Comments
    = render partial: 'groups/comment_form', locals: {comment: Comment.new, group: group}


.row
  .col-sm-12
    = render partial: 'groups/comments', locals: {comments: group.comments, group: group}
