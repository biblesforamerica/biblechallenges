.container
  .row
    .col-sm-6
      %h3
        =group.name
        .badge
          = group.members.count
          = "member".pluralize(group.members.count)

        /instant hangout not working properly
        /= instant_hangout

    .col-sm-6
      .pull-right
        - if current_user
          - if current_user.groups.include?(group)
            = link_to "Leave Group", leave_member_group_path(id: group.id), :class=>"btn btn-info", method: :post, data: {confirm: "Are you sure you want to leave this group?"}
          -else
            = link_to "Join Group", join_member_group_path(id: group.id), :class=> "btn btn-primary", method: :post
        - else
          = link_to "Sign me up", new_user_registration_path, :class=> "btn btn-primary"
        %span
        - if current_user && group.user_id == current_user.id
          = link_to "Delete Group", member_group_path(id: group.id), :class=>"btn btn-danger", method: :delete, data: {confirm: "Are you sure you want to delete this group?"}

  %table.table.table-striped.table-bordered.table-hover
    %thead
      %tr
        %th Members
        %th Stats
        %th Last Read
    %tbody
    - group.members.sort_by(&:email).each do |m|
      %tr
        %td
          = render 'shared/avatar', user: m
          %span
            = m.decorate.name
        %td= m.show_progress_percentage(m, group)
        - if m.has_logged_a_reading?(m, group)
          %td= m.decorate.show_last_recorded_reading(m, group)
        - else
          %td
            No readings yet


  %h4 Group Comments
  = render partial: 'groups/comment_form', locals: {comment: Comment.new, group: group}
  = render partial: 'groups/comments', locals: {comments: group.comments, group: group}
